#!/bin/bash
# This is a unique configuration file for this probe.
# Variables must be set to either 'enable' or 'disable' (if it's a feature being enabled or disabled)

# Version of the config file
chprobe_configversion=3

###
### General settings
###

# Don't touch this
chprobe_commit=false
chprobe_cmd=false

# Cron user
cron_user=root

# Probe directory (where all scripts are located)
probedir=/home/chprobe/

# Enable and disable Probemanager
# Default: enable
chprobe_probemanager=enable

# How often to call home (minutes)
# Interval: 20-60
# Default: 20
callhome_interval=20

# Backups
# Enables preconfigured cronjob to back up the /home dir every Sunday at 07:05 AM
chprobe_backup=enable

# Enable/disable SSH Tunnel
# Default: disable
ssh_tunnel=enable

# Unique timer in seconds (this value should be unique for every probe)
chprobe_timer=5

# Controls whether default probe_settings in the tarball is loaded
# Disable this feature to freely edit the crontab and other settings to your liking
# Note: This setting has to be enabled for any cron-related configuration below to function.
# Default: enable
probe_settings=enable

# Enable or disable logrotation
chprobe_logrotate=enable

# Enable or disable crontab
chprobe_crontab=enable

# Enable or disable rc.local
chprobe_rc_local=enable

# Enable or disable uPnP
chprobe_upnp=enable

# Modify the uPnP timer for SSH. This is how long the lease time for the port forward is active in the gateway
# Default value is 1800 sec or 30min, which syncs with the default crontab renewing schedule. Use '0' to make a permanent entry.
# If the timer is between 60 and 3600 sec, the crontab will be configured accordingly
chprobe_upnp_timer=1800

# Custom firewall input exceptions
# Use iptables syntax (These rules will be appended att the bottom of the input chain)
# Example: chprobe_customfwrule1="-s 192.168.0.1/24 -p tcp -m tcp --dport 80"
# Increase the array to add more rules
# Default: disable
chprobe_customrule=disable
chprobe_customfwrule[0]="-s 192.168.0.1/24 -p tcp -m tcp --dport 80"
chprobe_customfwrule[1]="-s 192.168.0.1/24 -p tcp -m tcp --dport 21"

# Iperf3 server
# Use the probe as an iperf3 server. 
# This will install a systemd service and a script that will make sure that the daemon stays alive no matter what.
# croninterval
# Default: disable
chprobe_iperf3_localserver=disable

# Iperf3 server firewall
# Use iptables syntax
# Default: 192.168.0.1/16 tcp ports 5201-5220
chprobe_iperf3_firewall="-s 192.168.0.1/16 -p tcp -m tcp --dport 5201:5220"

# Set the port the iperf3 daemon should listen on
# Range: 1000 to 65535
# Default: 5201
chprobe_iperf3_serverport=5201

# Set the interval (minutes) for the cron script to check the iperf3 server status
# Range: 2 to 60
# Default: 10 min
chprobe_iperf3_croninterval=10

# IPv6 settings
# "auto" - Dual-Stack mode will be enabled if there is IPv6 connectivty
# "disable" - Force IPv4 only
# "enable" - Force IPv6 only
# Default: "auto"
chprobe_ipv6=auto

###
### Test settings
###

# Enable or disable BBK
chprobe_bbk=enable
chprobe_bbk_ipv6=enable

# Set the interval for bbk tests (minutes)
# Range: 2 to 60
# Default: 15 and 16 min
chprobe_bbk_interval=15
chprobe_bbk_interval_ipv6=16

# Iperf3 TCP
# Enable or disable iperf3 TCP tests
chprobe_iperf3tcp=enable
chprobe_iperf3tcp_ipv6=enable

# Iperf3 TCP target
# Set the IP or hostname of target, or disable to use zone configured server
# Adding port also works, e.g "iperf.server.com -p 5210" (use double quotes)
# Default: disable
chprobe_iperf3tcp_target=disable

# Iperf3 TCP sessions
# Configure the amount of parallel TCP sessions to use
# Range 1 to 30
# Default: 15
chprobe_iperf3tcp_sessions=15

# Iperf3 test duration (seconds)
# Range 10 to 300
# Default: 12
chprobe_iperf3tcp_duration=12

# iperf3 omit duration (seconds)
# Range 2 to 300
# Default: 2
chprobe_iperf3tcp_omitduration=2

# Set the interval (minutes)
# Range: 2 to 60
# Default: 15 and 16 min
iperf3tcp_ds_interval=15
iperf3tcp_us_interval=16
iperf3tcp_ds_interval_ipv6=15
iperf3tcp_us_interval_ipv6=16


# Iperf3 UDP random bandwidth streams
# Enable or disable iperf3 UDP tests
chprobe_iperf3udp=enable

# Configuare the test length (10-600 seconds) and bandwidth (1-300 Mbit/s) per stream
# Note: For high speed udp streams, use "highudp" instead.
# These streams are meant coexist with all tests.

# Stream 1
chprobe_iperf3udp_stream_b1=5
chprobe_iperf3udp_stream_t1=60

# Stream 2
chprobe_iperf3udp_stream_b2=10
chprobe_iperf3udp_stream_t2=60

# Stream 3
chprobe_iperf3udp_stream_b3=20
chprobe_iperf3udp_stream_t3=60

# Set the interval (minutes) for the udp streams
# Range: 2 to 60
# Default: 15 and 16 min
iperf3udp_ds_interval=5
iperf3udp_us_interval=6

# Iperf3 high-speed UDP
# Enable or disable iperf3 UDP high-speed tests
# Default: disable
chprobe_iperf3highudp=disable

# Set the interval (minutes)
# Range: 2 to 60
# Default: 15 and 16 min
iperf3highudp_ds_interval=15
iperf3highudp_us_interval=16

# Configure the amount of sessions(1-30) length(10-300) and bandwidth (1-10000 Mbit/s)
# Default: 2 sessions,60 minutes,100mbit respectively
chprobe_iperf3udp_sessions=2
chprobe_iperf3udp_length=60
chprobe_iperf3udp_bandwidth=100

### HTTPS Tests
# Enable or disable HTTPS tests
chprobe_https=enable

# Set the interval (minutes)
# Range 2 to 60
# Default: 2
https_interval=2

# Set the target domain or ip (not url)
https_target=www.facebook.com

### DNS Tests

# Enable or disable DNS query tests
chprobe_dns=enable

# Configure the cron interval,name server to query and domain to query
dig_interval=2
dig_server=auto # Use 'auto' to use the configured primary DNS
dig_server_ipv6=auto # Use 'auto' to use the configured primary DNS
dig_target=sunet.se

### Multi session HTTP tests

# Enable or disable
chprobe_wrk=enable

# Set the cron interval in minutes
# Default: 1
# Interval: 1-60
wrk_interval=12

# Set the amount of workers to be used by the daemon
# Default: 3
# Interval: 3-10
wrk_workers=3

# Set the amount of HTTP sessions to be used
# Default: 200
# Interval: 1-5000
wrk_sessions=200

# Set the duration of the test in seconds
# Default: 30
# Interval: 10-360
wrk_duration=30

# Set the target url
wrk_target="http://google.se"


### ICMP Tests
# Enable or disable ICMP Ping tests
chprobe_icmp=enable

# Set the amount of daemons to run in paralell
# Interval: Not yet supported
# Default: 3
chprobe_icmp_daemons=3

# Set the packet interval,packet size,amount of packets,targets and cron interval per daemon
# Interval: 0.5-100 (sec),54-9000 (bytes),5-100 (packets) and 2-60 (min)
# Above values are the variable intervals for pinterval,psize,packets and cron interval respectively
# Note: The configuration for the cron intervals (cron_interval) will only apply if the probe is NOT in strict mode

# Cron intervals
icmp_cron_interval=2
icmp_cron_interval_ipv6=2

# Daemon 1
icmp1_interval=1
icmp1_size=54
icmp1_packets=100
icmp1_target=ping.sunet.se

# Daemon 2
icmp2_interval=0.5
icmp2_size=54
icmp2_packets=100
icmp2_target=ping.sunet.se

# Daemon 3
icmp3_interval=1
icmp3_size=1800
icmp3_packets=100
icmp3_target=sunet.se

# Ansible PATH
if [ `uname -m` != "armv7l" ]; then
PATH=/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/chprobe/.local/bin:/home/chprobe/bin
fi
